!function(){var r;(r=function(t,e){return null==e&&(e={}),this instanceof r?(this._={},this._.exclude=e.exclude||[],this._.computed=e.computed||{},this._.deps={},this._.tracking=null,this._.trackingPath=[],this._.currentDeps=null,this._.proxy=null,this._.proxyCache=new WeakMap,this._.watchers={},this._.batchMode=!1,this._.pendingChanges=[],this._.data=null,this.evtHandler={},null!=t&&this.set(t),this):new r(t,e)}).create=function(t,e){return new r(t,e)},r.prototype=function(t,e){var r,n={}.hasOwnProperty;for(r in e)n.call(e,r)&&(t[r]=e[r]);return t}(Object.create(Object.prototype),{on:function(t,r){var n=this;return(Array.isArray(t)?t:[t]).map(function(t){var e;return((e=n.evtHandler)[t]||(e[t]=[])).push(r)}),this},fire:function(t){for(var e,r,n,i,s=[],h=[],a=1,o=arguments.length;a<o;++a)h.push(arguments[a]);for(e=h,a=0,n=(r=this.evtHandler[t]||[]).length;a<n;++a)i=r[a],s.push(i.apply(this,e));return s},set:function(t){return this._.data=t,this._.proxy=null,this._.proxyCache=new WeakMap,this.fire("set",t),this},get:function(){return!this._.proxy&&this._.data&&(this._.proxy=this._createProxy(this._.data,[])),this._.proxy},raw:function(){return this._.data},track:function(t,e){var r,n,i,s,h=this._.tracking,a=this._.currentDeps;this._.tracking=t,this._.currentDeps=new Set;try{e()}finally{r=Array.from(this._.currentDeps),this._.tracking=h,this._.currentDeps=a}for(n=0,i=r.length;n<i;++n)s=r[n],this._.deps[s]||(this._.deps[s]=new Set),this._.deps[s].add(t);return this.fire("track",t,r),r},untrack:function(t){var e,r;for(e in r=this._.deps)r[e].delete(t);return this},watch:function(t,e){return this._.watchers[t]||(this._.watchers[t]=[]),this._.watchers[t].push(e),this},batch:function(t){var e=this._.batchMode;this._.batchMode=!0;try{t()}finally{this._.batchMode=e,this._flushChanges()}return this},_createProxy:function(t,i){var e,s;return"object"!=typeof t||!t||i.length&&function(t,e){var r=-1,n=e.length>>>0;for(;++r<n;)if(t===e[r])return 1;return}(i[0],this._.exclude)?t:this._.proxyCache.has(t)?this._.proxyCache.get(t):(e=Array.isArray(t)?this._createArrayProxy(t,i):(s=this,new Proxy(t,{get:function(t,e){var r;return"symbol"==typeof e||e.toString().startsWith("_")||"constructor"===e?Reflect.get(t,e):(r=i.length?i.join(".")+"."+e:e.toString(),s._.tracking&&s._.currentDeps&&s._.currentDeps.add(r),"object"==typeof(r=Reflect.get(t,e))&&null!==r?s._createProxy(r,i.concat([e])):r)},set:function(t,e,r){var n=t[e],t=Reflect.set(t,e,r);return n!==r&&(e=i.length?i.join(".")+"."+e:e.toString(),s._trigger(e,r,n)),t}})),this._.proxyCache.set(t,e),e)},_createArrayProxy:function(t,a){var o=this,e=new Proxy(t,{get:function(s,h){var t;return"push"===h||"pop"===h||"shift"===h||"unshift"===h||"splice"===h||"sort"===h||"reverse"===h?function(){for(var t,e,r=[],n=0,i=arguments.length;n<i;++n)r.push(arguments[n]);return t=r,t=s[h].apply(s,t),e=a.length?a.join("."):"root",o._trigger(e,s,s),t}:(isNaN(parseInt(h))||(t=a.length?a.join(".")+"."+h:h.toString(),o._.tracking&&o._.currentDeps&&o._.currentDeps.add(t)),"object"==typeof(t=Reflect.get(s,h))&&null!==t?o._createProxy(t,a.concat([h])):t)},set:function(t,e,r){var n=t[e],t=Reflect.set(t,e,r);return n!==r&&(e=a.length?a.join(".")+"."+e:e.toString(),o._trigger(e,r,n)),t}});return this._.proxyCache.set(t,e),e},_trigger:function(t,e,r){for(var n,i=Array.from(this._.deps[t]||[]),s=0,h=(n=this._.watchers[t]||[]).length;s<h;++s)n[s].call(this,e,r);return this._.batchMode?this._.pendingChanges.push({key:t,value:e,oldValue:r,dependents:i}):this.fire("change",t,e,r,i),this},_flushChanges:function(){var t,e,r,n,i,s,h,a;if(this._.pendingChanges.length){for(t=new Set,e=0,n=(r=this._.pendingChanges).length;e<n;++e)for(i=0,h=(s=r[e].dependents).length;i<h;++i)a=s[i],t.add(a);return this.fire("batch-change",this._.pendingChanges,Array.from(t)),this._.pendingChanges=[],this}}}),"undefined"!=typeof module&&null!==module&&(module.exports=r),"undefined"!=typeof window&&null!==window&&(window.ldreactive=r)}.call(this);
